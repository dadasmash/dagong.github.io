---
layout: archive
title: ""
permalink: /teaching_mid_survey/
author_profile: true
---
<!--Ref:https://www.geeksforgeeks.org/build-a-survey-form-using-html-and-css/  -->
<!-- Google Apps Script Tutorial - Saving Form Data to Google Sheets -->
<!-- https://github.com/jamiewilson/form-to-google-sheets?tab=readme-ov-file -->
<!--Set Up Google Apps Script
     0. Go to Google Sheets and create a new sheet.
        Rename the sheet to SurveyResponses.
        In row 1, add column headers: e.g. Name, Email, Feedback
    1. In your Google Sheet, click Extensions > Apps Script.  
    2. Delete any existing code and paste the following javascript:
function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("SurveyResponses");
  var data = JSON.parse(e.postData.contents);
  sheet.appendRow([data.name, data.email, data.feedback]);
  return ContentService.createTextOutput("Success").setMimeType(ContentService.MimeType.TEXT);
}
Notes: need to change column names accordingly; need to repalce "SurveyResponses" with google sheet name
3. Click Deploy > New Deployment.
4. Select "Web App", set "Anyone" as the access level.
5. Click Deploy and Authorize the script.
6. Copy the web app URL (e.g., https://script.google.com/macros/s/.../exec).
7. Replace "YOUR_GOOGLE_SCRIPT_URL_HERE" with your Google Apps Script URL from Step 2.
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" 
          content="IE=edge">
    <meta name="viewport" 
          content="width=device-width, initial-scale=1.0">
    <title>
<!--         Build a Survey Form using HTML and CSS -->
    </title>

    <style>
        /* Styling the Body element 
        i.e. Color, Font, Alignment */
        body {
            background-color: #FFFFFF;
            font-family: Verdana;
            text-align: center;
        }

        /* Styling the Form (Color, Padding, Shadow) */
        form {
            background-color: #fff;
            max-width: 500px;
            margin: 50px auto;
            padding: 30px 20px;
            box-shadow: 2px 5px 10px rgba(0, 0, 0, 0.5);
        }

        /* Styling form-control Class */
        .form-control {
            text-align: left;
            margin-bottom: 25px;
        }

        /* Styling form-control Label */
        .form-control label {
            display: block;
            margin-bottom: 10px;
        }

        /* Styling form-control input, 
        select, textarea */
        .form-control input,
        .form-control select,
        .form-control textarea {
            border: 1px solid #777;
            border-radius: 2px;
            font-family: inherit;
            padding: 10px;
            display: block;
            width: 95%;
        }

        /* Styling form-control Radio 
        button and Checkbox */
        .form-control input[type="radio"],
        .form-control input[type="checkbox"] {
            display: inline-block;
            width: auto;
        }

        /* Styling Button */
        button {
            background-color: #05c46b;
            border: 1px solid #777;
            border-radius: 2px;
            font-family: inherit;
            font-size: 21px;
            display: block;
            width: 100%;
            margin-top: 50px;
            margin-bottom: 20px;
        }
    </style>
</head>

<body>
    <h1>Mid-Semester Survey</h1>

    <!-- Create Form -->
    <form id="form">

        <!-- Courses -->
       <div class="form-control">
            <label> Which course are you enrolling in?
                <small>(Check all that apply)</small>
            </label>
            <!-- Input Type Checkbox -->
            <label for="course-1">
                <input type="checkbox" name="course"> DANL101-01
                  </input>
              </label>
            <label for="course-2">
                <input type="checkbox" name="course"> DANL101-02
                  </input>
            </label>
            <label for="course-3">
                <input type="checkbox" name="course"> MGMT350
                  </input>
            </label>
            <label for="course-4">
                <input type="checkbox" name="course"> DANL202
                  </input>
        </div>

           <!--  4 stages of College-->
         <div class="form-control">
            <label for="stage" id="label-stage">
                Which option best describes you?
            </label>
            <!-- Dropdown options -->
            <select name="stage" id="stage">
                <option value="first year">first year</option>
                <option value="intern">sophomore</option>
                <option value="junior">junior</option>
                <option value="senior">senior</option>
            </select>
        </div>

         
            <!-- Comments on organization-->
          <div class="form-control">
            <label for="organization">
                Please share your thoughts on the organization of the course?
            </label>

            <!-- multi-line text input control -->
            <textarea name="organization" id="organization" 
                      placeholder="organization">
            </textarea>
        </div>


          <!-- interesting-->
          <div class="form-control">
            <label for="interesting">
                Which topic in this course has been the most interesting so far?
            </label>

            <!-- multi-line text input control -->
            <textarea name="interesting" id="interesting" 
                      placeholder="interesting">
            </textarea>
        </div>

          <!-- boring-->
          <div class="form-control">
            <label for="boring">
                Which topic in this course has been the most boring so far?
            </label>

            <!-- multi-line text input control -->
            <textarea name="boring" id="boring" 
                      placeholder="boring">
            </textarea>
        </div>

         <!-- challenging-->
          <div class="form-control">
            <label for="challenging">
                Which part of this course has been the most challenging or confusing so far?
            </label>

            <!-- multi-line text input control -->
            <textarea name="challenging" id="challenging" 
                      placeholder="challenging">
            </textarea>
        </div>

         
        <div class="form-control">
            <label>
                Are you satisfied with your midterm grades?
            </label>
            <!-- Input Type Radio Button -->
            <label for="satisfied-1">
                <input type="radio" id="satisfied-1" 
                       name="satisfied"> Yes
                  </input>
            </label>
            <label for="satisfied-2">
                <input type="radio" id="satisfied-2" 
                       name="satisfied"> No
                  </input>
            </label>
            <label for="satisfied-3">
                <input type="radio" id="satisfied-3" 
                       name="satisfied"> I don't care
                  </input>
            </label>
        </div>

        

        <div class="form-control">
            <label for="comment">
                Do you have any comments or suggestions about this class so far?
            </label>

            <!-- multi-line text input control -->
            <textarea name="comment" id="comment" 
                      placeholder="Enter your comment here">
            </textarea>
        </div>

        <!-- Multi-line Text Input Control -->
        <button type="submit" value="submit">
            Submit
        </button>
    </form>

 <script>      
        document.getElementById("form").addEventListener("submit", async function(event) {
    event.preventDefault();

    // Get all selected checkboxes
    const selectedCourses = Array.from(document.querySelectorAll('input[name="course"]:checked'))
                                 .map(checkbox => checkbox.nextSibling.textContent.trim());

    const formData = {
        course: selectedCourses.join(", "),  // Join selected courses as a comma-separated string
        stage: document.getElementById("stage").value,
        organization: document.getElementById("organization").value,
        interesting: document.getElementById("interesting").value,
        boring: document.getElementById("boring").value,
        challenging: document.getElementById("challenging").value,
        satisfied: document.querySelector('input[name="satisfied"]:checked') ? 
                   document.querySelector('input[name="satisfied"]:checked').nextSibling.textContent.trim() : "No response",
        comment: document.getElementById("comment").value
    };

    const response = await fetch("https://script.google.com/macros/s/AKfycbx2HbDL1JDFWVBS23Pdv8kypcfjb6abA1Uq_mBS0MSQ2oetqt1wAJspHDoWzn-wkIkZ/exec", {
        method: "POST",
        body: JSON.stringify(formData),
        headers: { "Content-Type": "application/json" }
    });

    if (response.ok) {
        alert("Survey submitted successfully!");
        this.reset();
    } else {
        alert("Submission failed.");
    }
});
</script>
</body>
</html>
